מודל התחזית של Playmaker והסבר על דירוג Elo – הסבר מקיף (עברית)

סקירה כללית
Playmaker הוא מערך אנליטיקה לכדורגל שמטרתו לחזות את תוצאות משחקים (1X2) ולהציג הסתברויות מנורמלות לשלוש תוצאות: ניצחון בית, תיקו, ניצחון חוץ. המודל נשען על בניית תכונות היסטוריות, התאמת מסווג למידת מכונה, כיול הסתברויות, ושילוב אופציונלי של דירוגי Elo כמדד עוצמה דינמי.

רכיבי המודל
1) נתונים: PostgreSQL עם משחקים היסטוריים (matches_cleaned/raw_matches) ותוצאות; fixture למשחקים עתידיים.
2) תכונות: מדדים מתגלגלים (שערים בעד/נגד, פורם 5/10), יתרון ביתיות, Elo, ולעיתים יחסי הימורים.
3) מסווג: RF/GBM/Logit/LightGBM/XGBoost – מפיק p_home, p_draw, p_away (סכום = 1).
4) כיול: Platt/Temperature/Reliability כדי ליישר הסתברויות לתדירויות בפועל.
5) כתיבה והצגה: כתיבה ל‑prediction; ה‑API מאחד תחזיות עם נתוני משחק; ה‑UI מציג.

Elo בקצרה
- עוצמה יחסית מתעדכנת לאחר כל משחק לפי הפער בין תוצאה צפויה לפועל.
- הסתברות צפויה: P(home) = 1 / (1 + 10^(-(ΔElo)/400)).
- יתרון ביתיות: ~20–30 נק׳ Elo (≈3–7% הסתברותית) מתווסף לצד הבית.
- K‑factor: קובע רגישות העדכון; K גבוה = שינוי מהיר יותר.
- תיקו: קובעים שיעור p_draw (למשל 22–32% לפי פערי רמות), ואז משקללים: p_home *= (1‑p_draw), p_away *= (1‑p_draw).

למה Elo שימושי?
- נותן "זיכרון" דינמי לעוצמות קבוצות.
- קל לכיול/הטמעה כתכונה בתוך מודל ML.

שילוב Elo ב‑Playmaker
- מחשבים ΔElo "as‑of" לפני המשחק (ללא דליפה), מוסיפים HA.
- ניתן לקנפג K/HA לפי ליגה.

הערכת ביצועים (Backtest)
- מדדים: Accuracy (פגיעות), Brier (דיוק הסתברויות), Log Loss.
- טיפוסי: 45–48% דיוק על כלל המשחקים (מעל 33% אקראי). 51% על כלל המשחקים נדיר; אפשרי על תתי‑קבוצות (סינון ביטחון).

איך מתקדמים ל‑51%?
- סינון לפי ביטחון: לדוגמה max(prob) ≥ 0.50 מעלה דיוק על תת‑סט.
- פיצ׳רים: יחסי הימורים מנורמלים, פורם, ימי מנוחה, מרחק נסיעות, פציעות/סגל (אם זמין).
- מודלים מתקדמים/אנסמבלים וכיול פר‑ליגה.
- CV לפי זמן והקפדה על as‑of למניעת דליפה.

שילוב בדוחות ו‑API
- prediction משמש להצגה ב‑/fixtures/upcoming_with_odds.
- /model_metrics קורא את model_version.metrics ומוצג בעמוד Analytics.

סיכום
Elo מספק בסיס עוצמה דינמי; בשילוב היסטוריה ופיצ׳רים איכותיים מתקבלות הסתברויות 1X2 יציבות. דיוק כולל >50% לכל המשחקים אינו שכיח, אך ≥51% אפשרי על משחקים בעלי ביטחון גבוה, עם שיפורי פיצ׳רים/כיול וניהול דליפה.
